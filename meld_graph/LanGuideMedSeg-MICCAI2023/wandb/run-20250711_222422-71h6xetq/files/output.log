/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
⚠️ Эти участники отсутствуют и будут пропущены: ['sub-00120']
141 19 9
[INFO] Loading model from checkpoint: ./save_model/medseg-v1.ckpt
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/utilities/cloud_io.py:48: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=map_location)
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/transformers/modeling_utils.py:399: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location="cpu")
Some weights of the model checkpoint at StanfordAIMI/RadBERT were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.bias', 'cls.predictions.transform.dense.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/plugins/environments/slurm.py:166: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 train.py ...
  rank_zero_warn(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
start testing
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[INFO] Loading model from checkpoint: ./save_model/medseg-v1.ckpt
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/utilities/cloud_io.py:48: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=map_location)
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/transformers/modeling_utils.py:399: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location="cpu")
Some weights of the model checkpoint at StanfordAIMI/RadBERT were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.bias', 'cls.predictions.transform.dense.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/plugins/environments/slurm.py:166: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 train.py ...
  rank_zero_warn(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Restoring states from the checkpoint path at ./save_model/medseg-v1.ckpt
Loaded model weights from checkpoint at ./save_model/medseg-v1.ckpt
Testing DataLoader 0:   0%|                                                                            | 0/3 [00:00<?, ?it/s]/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00136/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/monai/data/__init__.py:120: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  t = cls([], dtype=storage.dtype, device=storage.device)
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00136/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00145/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00145/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00121/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00121/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00004/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00004/xhemi/classifier/rh.prediction.mgh
---- sub-00136 ----
 acc = 0.9974
spec = 0.0020
dice = 0.2072
 ppv = 0.1479
MIoU = 0.1166
---- sub-00145 ----
 acc = 0.9968
spec = 0.0025
dice = 0.4354
 ppv = 0.3290
MIoU = 0.2717
---- sub-00121 ----
 acc = 0.9976
spec = 0.0013
dice = 0.1559
 ppv = 0.1379
MIoU = 0.0828
---- sub-00004 ----
 acc = 0.9963
spec = 0.0022
dice = 0.2016
 ppv = 0.1783
MIoU = 0.1119
Testing DataLoader 0:  33%|██████████████████████▎                                            | 1/3 [06:07<12:15, 367.71s/it]/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00043/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00043/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00006/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00006/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00074/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00074/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00095/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00095/xhemi/classifier/rh.prediction.mgh
---- sub-00043 ----
 acc = 0.9968
spec = 0.0021
dice = 0.2926
 ppv = 0.2453
MIoU = 0.1707
---- sub-00006 ----
 acc = 0.9958
spec = 0.0040
dice = 0.0000
 ppv = 0.0000
MIoU = 0.0000
---- sub-00074 ----
 acc = 0.9969
spec = 0.0015
dice = 0.0000
 ppv = 0.0000
MIoU = 0.0000
---- sub-00095 ----
 acc = 0.9971
spec = 0.0008
dice = 0.0070
 ppv = 0.0175
MIoU = 0.0046
Testing DataLoader 0:  67%|█████████████▎      | 2/3 [12:06<06:03, 363.33s/it]                                               /home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00134/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00134/xhemi/classifier/rh.prediction.mgh
---- sub-00134 ----
 acc = 0.9963
spec = 0.0021
dice = 0.1097
 ppv = 0.0971
MIoU = 0.0576
Testing DataLoader 0: 100%|████████████████████| 3/3 [13:33<00:00, 271.18s/it]
[TEST  epoch 0] loss=0.6816, acc=0.9961, fp=0.0019,  ppv=0.0000, dice=0.0000, MIoU=0.0000

=== OVERALL TEST METRICS ===
Dice : 0.153 (0.000-0.410)
PPV  : 0.138 (0.000-0.328)
IoU  : 0.083 (0.000-0.258)
Acc  : 0.997 (0.996-0.998)
Testing DataLoader 0: 100%|████████████████████| 3/3 [13:33<00:00, 271.19s/it]
──────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
──────────────────────────────────────────────────────────────────────────────
        test_MIoU                   0.0
        test_acc            0.9960994124412537
        test_dice                   0.0
        test_loss           0.6816098093986511
        test_ppv                    0.0
        test_spec          0.0018519759178161621
──────────────────────────────────────────────────────────────────────────────
=== TEST metrics ===
[{'test_loss': 0.6816098093986511, 'test_acc': 0.9960994124412537, 'test_spec': 0.0018519759178161621, 'test_dice': 0.0, 'test_ppv': 0.0, 'test_MIoU': 0.0}]
