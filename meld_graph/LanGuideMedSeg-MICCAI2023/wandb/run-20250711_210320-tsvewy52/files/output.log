/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
⚠️ Эти участники отсутствуют и будут пропущены: ['sub-00120']
141 19 9
[INFO] Loading model from checkpoint: ./save_model/medseg.ckpt
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/utilities/cloud_io.py:48: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=map_location)
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/transformers/modeling_utils.py:399: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location="cpu")
Some weights of the model checkpoint at StanfordAIMI/RadBERT were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.predictions.decoder.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/plugins/environments/slurm.py:166: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 train.py ...
  rank_zero_warn(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
start testing
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[INFO] Loading model from checkpoint: ./save_model/medseg.ckpt
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/utilities/cloud_io.py:48: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=map_location)
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/transformers/modeling_utils.py:399: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(checkpoint_file, map_location="cpu")
Some weights of the model checkpoint at StanfordAIMI/RadBERT were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.predictions.decoder.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/lightning_fabric/plugins/environments/slurm.py:166: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 train.py ...
  rank_zero_warn(
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Restoring states from the checkpoint path at ./save_model/medseg.ckpt
Loaded model weights from checkpoint at ./save_model/medseg.ckpt
Testing DataLoader 0:   0%|                                                                                     | 0/3 [00:00<?, ?it/s]/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00136/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/miniconda3/envs/MELD-env/lib/python3.9/site-packages/monai/data/__init__.py:120: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  t = cls([], dtype=storage.dtype, device=storage.device)
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00136/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00145/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00145/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00121/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00121/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00004/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00004/xhemi/classifier/rh.prediction.mgh
---- sub-00136 ----
 acc = 0.9960
spec = 0.0034
dice = 0.1616
 ppv = 0.0953
MIoU = 0.0818
---- sub-00145 ----
 acc = 0.9935
spec = 0.0058
dice = 0.3257
 ppv = 0.1881
MIoU = 0.1730
---- sub-00121 ----
 acc = 0.9954
spec = 0.0036
dice = 0.1294
 ppv = 0.0767
MIoU = 0.0617
---- sub-00004 ----
 acc = 0.9941
spec = 0.0044
dice = 0.1766
 ppv = 0.1174
MIoU = 0.0911
Testing DataLoader 0:  33%|█████████████████████████▎                                                  | 1/3 [06:10<12:20, 370.02s/it]/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00043/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00043/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00006/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00006/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00074/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00074/xhemi/classifier/rh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00095/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00095/xhemi/classifier/rh.prediction.mgh
---- sub-00043 ----
 acc = 0.9942
spec = 0.0047
dice = 0.2189
 ppv = 0.1442
MIoU = 0.1207
---- sub-00006 ----
 acc = 0.9898
spec = 0.0100
dice = 0.0000
 ppv = 0.0000
MIoU = 0.0000
---- sub-00074 ----
 acc = 0.9941
spec = 0.0043
dice = 0.0000
 ppv = 0.0000
MIoU = 0.0000
---- sub-00095 ----
 acc = 0.9958
spec = 0.0021
dice = 0.0214
 ppv = 0.0297
MIoU = 0.0151
Testing DataLoader 0:  67%|██████████████████████████████████████████████████▋                         | 2/3 [12:11<06:05, 365.94s/it]/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00134/xhemi/classifier/lh.prediction.mgh
/home/s17gmikh/FCD-Detection/meld_graph/data/output/fs_outputs/sub-00134/xhemi/classifier/rh.prediction.mgh
---- sub-00134 ----
 acc = 0.9934
spec = 0.0051
dice = 0.0812
 ppv = 0.0530
MIoU = 0.0412
Testing DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████| 3/3 [13:39<00:00, 273.31s/it]
[TEST  epoch 0] loss=0.6893, acc=0.9952, fp=0.0028,  ppv=0.0000, dice=0.0000, MIoU=0.0000

=== OVERALL TEST METRICS ===
Dice : 0.116 (0.000-0.287)
PPV  : 0.077 (0.000-0.186)
IoU  : 0.062 (0.000-0.168)
Acc  : 0.994 (0.990-0.996)
Testing DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████| 3/3 [13:39<00:00, 273.33s/it]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        test_MIoU                   0.0
        test_acc            0.9951906800270081
        test_dice                   0.0
        test_loss           0.6892933249473572
        test_ppv                    0.0
        test_spec           0.00276261568069458
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
=== TEST metrics ===
[{'test_loss': 0.6892933249473572, 'test_acc': 0.9951906800270081, 'test_spec': 0.00276261568069458, 'test_dice': 0.0, 'test_ppv': 0.0, 'test_MIoU': 0.0}]
